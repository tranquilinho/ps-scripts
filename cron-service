#!/bin/bash

readonly service_cfg=${0%/scripts*}/etc/service.cfg

. ${service_cfg} 

readonly log_file=${service_log}
readonly module="cron"
readonly log_facility="${service}-${module}"
readonly daemon=${usr_prefix}/sbin/anacron
readonly pidfile=${run_dir}/${module}.pid

. ${scripts_base}/common

case "$1" in
    "start")
	log "${info} Starting ${module}"
	if [ ! -f ${daemon} ]; then
            ${scripts_base}/build/cron
    	fi
	
	readonly spool_dir="${data_dir}/spool/anacron"
	[ ! -d ${spool_dir} ] && mkdir -p ${spool_dir}

	readonly crontab="${etc_dir}/anacrontab"
	[ ! -f ${crontab} ] && echo "Missing ${crontab}" && exit 2

	daemon_start ${daemon} " " ${pidfile}
	;;

	"stop")
	daemon_stop ${pidfile}
	;;

	*)
	echo "Syntax: $0 [start|stop]"
esac
exit 0
