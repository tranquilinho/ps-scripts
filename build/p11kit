#!/usr/bin/env bash

readonly service_cfg=${0%/scripts*}/etc/service.cfg

. ${service_cfg} && . ${scripts_base}/common

readonly pkg_name=p11-kit
readonly pkg_version=0.23.2
readonly url_base=https://p11-glue.freedesktop.org/releases/

build_preconditions

install_prereq pkgconfig "mandatory"
install_prereq libtasn "mandatory"
install_prereq libffi "mandatory"

export PATH=${usr_prefix}/pkg-config/bin:${PATH}

# configure looks for ca-certificates.crt, ca-bundle.crt 
# ca-bundle.pem and ca-bundle.crt in sysconfdir/ssl/certs/ and
# trust-path
# initially, p11kit will be used to manage OS certificates,
# therefore we use OS sysconfdir (/etc) instead of ${etc_dir}
./configure --prefix=${prefix} --sysconfdir=/etc --without-trust-paths

standard_install
