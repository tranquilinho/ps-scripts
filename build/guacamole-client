#!/bin/bash

readonly service_cfg=${0%/scripts*}/etc/service.cfg

. ${service_cfg} && . ${scripts_base}/common

readonly pkg_name=guacamole-client
readonly pkg_version=0.9.14
readonly url_base=http://ftp.cixug.es/apache/guacamole/${pkg_version}/source/

install_prereq maven "mandatory"
# it seems the client only works with "old" servlet spec v2.5, 
# which in Tomcat terms means Tomcat 6.X
install_prereq tomcat "mandatory" 

# depends on java

spack load jdk

build_preconditions

# create the .war file
${usr_prefix}/maven/bin/mvn package
# install it in tomcat
cp guacamole/target/guacamole-${pkg_version}.war ${usr_prefix}/apache-tomcat/webapps

exit $?

