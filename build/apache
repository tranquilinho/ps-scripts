#!/bin/bash

readonly scripts_cfg=${0%/scripts*}/etc/scripts.cfg

. ${scripts_cfg} && . ${scripts_base}/common

readonly pkg_name=httpd
readonly pkg_version=2.4.9
readonly url_base=http://ftp.cixug.es/apache//httpd
readonly expected_hash=50496e51605a3d852c183a7c667c25bcc7ee658d

install_prereq apr "mandatory"
install_prereq apr-util "mandatory"
install_prereq pcre "mandatory"
install_prereq openssl "mandatory"

build_preconditions

cat ${scripts_base}/build/apache-portable.layout >> config.layout

# for ldap support in apache, apr-util must be build with ldap support too (specyfing where the ldap libs are)
./configure --prefix=${prefix} --enable-layout=Portable --datadir=${data_dir} --localstatedir=${service_root} --enable-pie -enable-authn-dbm --enable-authz-dbm --enable-ratelimit --enable-log-debug --enable-ssl --with-apr=${usr_prefix}/apr --with-apr-util=${usr_prefix}/apr-util --with-pcre=${usr_prefix}/pcre -with-ssl=${usr_prefix}/openssl

standard_install
